import socket
import threading


def EchoClientHandler(clientSocket, addr):
	while True:
		client_data = clientSocket.recv(2048)
		if client_data:
			clientSocket.send(client_data)
		else:
			clientSocket.close()
			return


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)

s.bind(("0.0.0.0", 42069))

s.listen(10)

while True:
	cSock, addr = s.accept()
	# start a new thread to service 
	print("Starting new thread to service client \n")
	thread = threading.Thread(target=EchoClientHandler, args=(cSock, addr))
	thread.start()
	


